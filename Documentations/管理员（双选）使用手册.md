# 使用手册--双选管理员端

## 职责说明

双选管理员会在双选期间完成下列任务：
1. 导入学生
2. 修改老师可选名额
3. 导入老师
4. 设置双选配置，例如，双选轮次，双选开放时间等等
5. 导出文件、导出选择情况
6. 等等

由于双选内容繁多，很多内容无法在系统上直接体现，大部分情况需要直接操作数据库，建议为双选管理员指定后台运维相关工作，负责整个系统。

## 详细操作说明

### Enrol、Degree
> 请不要怀疑为什么起这两个名字，这是历史原因

在已有的系统中，``Enrol``为学生类型，即学硕、专硕和非全日制，``Degree``为学生专业，但是这个学生专业是要匹配学生类型的，也就是说，``Degree``的取值可以为``计算数学 学硕``，或者``软件工程 专硕``。

一个学生都有且只有一个``Degree``, 这个``Degree``用于选择老师/被老师选择。

一个老师可以对某个``Degree``选择学生（由学院规定，双选管理员配置），但是选择的额度是有限的，选完就没有了。

当一个老师的某个``Degree``有剩余名额的时候，该``Degree``的学生才可以选择这个老师。

同理，当一个老师的某个``Enrol``有剩余名额的时候，该``Enrol``的学生才可以选择这个老师。

### Source

> 请不要怀疑为什么起这个名字，这是历史原因

``Source``为本科学校类型，即原965高校、原211高校等等。每个学生都有一个``Source``进行对应。

### 学生界面

双选管理员可以在学生界面查看学生信息，并且：
1. 修改学生信息，包括登录密码
2. 删除这个学生
3. 为这个学生选择老师（但是需要在“学生选择阶段”中才可以操作，具体的双选流程请看下文）
4. 导入学生、批量导入学生

导入学生之前，请先设置好``Enrol, Source, Degree``这三部分内容。

### 老师界面

双选管理员可以在老师界面查看老师信息，并且：
1. 修改老师信息，包括登录密码。另外，按照惯例来说，会在双选开始前为老师批量重设密码，这一步可以通过老师界面上面的按钮来完成。统一重设的密码不需要太复杂，但是需要提醒老师尽快**登录系统修改密码**。
2. 添加**单个**老师。
3. 修改老师的**双选配置**，即可以根据学院的要求对老师的``Enrol``, ``Degree``可选名额进行修改。注意，降低名额并不会删除已经选择的学生，例如，某个老师已经选择了3名学生，但是修改名额后规定只可以选2名学生，那么已经选择的3名学生并不会被删除。如果确实需要删除的话，请尝试使用“删除学生”的功能，必要时联系后台修改。
4. 查看老师已经选择的学生，并为老师选择学生或删除学生。

### 变量设置

请参考后文。

### 文件管理

学生在双选开始后、学生选择阶段开始前需要上传个人资料（例如，成绩单，身份证明之类的），这些文件格式可以为``pdf, png, jpg``等。双选管理员可以在文件管理查看所有的文件，并且统一对文件进行导出。


### 双选流程

**重点**，接下来将会讲述双选的整个流程

双选一共分为以下几个阶段：
1. 学生上传资料阶段
2. 学生选择老师阶段
3. 老师选择学生阶段1
4. 老师选择学生阶段2
5. 老师选择学生阶段3
6. 双选结束

请注意，在目前的规划中，老师选择学生阶段次数为3。

那么，双选管理员需要如何切换这些阶段呢，答案就是通过“变量设置”界面。

双选管理员可以通过设置变量来指定当前阶段和当前阶段的起始时间，这些变量分别为：
1. ``stage_count``: 指明阶段数，这个阶段数就是“老师选择学生阶段”的次数。
2. ``current_stage``: 指明当前所在的阶段，这个阶段的值取值范围为``-1, 0, 1, 2, ... stage_count``
3. ``begin_time``: 当前阶段开始时间
4. ``end_time``: 当前阶段结束时间

下面，将会根据``current_stage``来逐步介绍整个双选过程

#### ``current_stage === -1``
当处于这个阶段时，表示“学生选择老师阶段**前**”，也就是说，学生可以在这个阶段上传资料（当然，需要满足时间限制）

#### ``current_stage === 0``
当处于这个阶段时，表示“学生选择老师阶段”，在该阶段中，学生可以选择老师。那么学生可以选择多少个老师呢，这个选择老师是根据“志愿”来算的，也就是说，学生可以选择``stage_count``个老师。在当前的系统中，由于``stage_count===3``，因此学生可以选择3个志愿老师。

注意，学生在整个双选过程中，只选择一次老师，但是可以选择``stage_count``个老师，并且，学生可以对老师进行志愿排序。

#### ``1 <= current_stage <= stage_count``
在这些阶段中，老师将可以选择学生。这个选择是按照学生选择的志愿来安排的。

也就是说，学生的第一志愿老师可以在第一阶段选择这个学生。如果该老师确实选择了这个学生，那么这个学生就不会在第二、第三阶段进入到其他老师的选择列表当中；但是如果老师没有选择这个学生，那么学生的第二志愿老师可以在第二阶段选择这个学生，以此类推。当然，如果某个老师的名额已经满了，那么这个老师在那个阶段将无法选择（已满类型的）学生。

#### ``current_stage > stage_count``
表示双选结束。

在每次阶段结束后，新的阶段开始前，请注意备份或导出数据（例如，文件上传情况，学生/老师的选择情况）。

那么问题来了，是否存在某些学生，使得这个学生在整个双选结束后，仍然没有被任何老师选择呢。答案是有可能，并且还有很多。这时，我们需要让学生主动联系老师，并且联系后台管理员让这个学生与老师直接建立联系。

等到双选真正结束后，就可以联系后台管理员，将所有的学生导入到考勤系统当中。